enum NFTStatus {
  Deposited
  Listed
  Called
  Removed
}

type NFT @entity {
  id: ID!
  nftAddress: Bytes!
  tokenId: BigInt!

  status: NFTStatus!
  position: Position
  updateTimestamp: Int!
  positionEndTimestamp: Int

  callPoolAddress: Bytes!
  userAddress: Bytes!

  strikePriceGapIdx: Int!
  durationIdx: Int!
}

enum PositionStatus {
  Unexercised
  Exercised
}
type Position @entity {
  id: ID!
  userAddress: Bytes!
  nftAddress: Bytes!
  tokenId: BigInt!

  callPoolAddress: Bytes!
  exerciseTime: Int!
  endTime: Int!
  strikePrice: BigInt!
  premiumToOwner: BigInt!
  premiumToReserve: BigInt!

  status: PositionStatus!
  updateTimestamp: Int!
  createTimestamp: Int!
}

type NFTTransaction @entity(immutable: true) {
  id: Bytes!
  userAddress: Bytes!
  nftAddress: Bytes!
  tokenId: BigInt!
  soldPrice: BigInt!
  createTimestamp: Int!
  transactionHash: Bytes!
}

type UserStat @entity {
  id: ID! #userAddress
  accumulativeEarnings: BigInt!
}

type CallPoolStat @entity {
  id: ID! #callPoolAddress
  accumulativePremium: BigInt!
  totalNFTSales: BigInt!
  totalDepositedNFTs: Int!
  totalOptionContracts: Int!
}
